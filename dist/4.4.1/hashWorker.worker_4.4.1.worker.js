(()=>{importScripts("https://cdnjs.cloudflare.com/ajax/libs/spark-md5/3.0.2/spark-md5.min.js");self.onmessage=async function(e){if(console.log("message"),e.data.file&&"begin hash"==e.data.msg){const a=await(s=e.data.file,new Promise(((e,a)=>{var o=0,r=(performance.now(),s.size);const t=new FileReader,n=new SparkMD5.ArrayBuffer,l=2097152,d=Math.ceil(s.size/l);let i=0;console.log("start"),t.onload=s=>{console.log("loaded"),n.append(s.target.result),++i,i<d?c():e(n.end())},t.addEventListener("progress",(e=>{o+=e.loaded,Math.round(o/r*100)})),t.addEventListener("loadend",(e=>{e.total>0&&performance.now()})),t.onerror=()=>a(t.error);const c=()=>{const e=i*l,a=e+l>=s.size?s.size:e+l;t.readAsArrayBuffer(File.prototype.slice.call(s,e,a))};c()})));postMessage({status:"complete",hash:a}),self.close()}var s}})();