importScripts("https://cdnjs.cloudflare.com/ajax/libs/spark-md5/3.0.2/spark-md5.min.js");const incrementalMD5=e=>new Promise(((a,r)=>{var s=0,t=(performance.now(),e.size);const n=new FileReader,o=new SparkMD5.ArrayBuffer,i=2097152,d=Math.ceil(e.size/i);let l=0;n.onload=e=>{o.append(e.target.result),++l,l<d?c():a(o.end())},n.addEventListener("progress",(e=>{s+=e.loaded;Math.round(s/t*100)})),n.addEventListener("loadend",(e=>{if(e.total>0)performance.now()})),n.onerror=()=>r(n.error);const c=()=>{const a=l*i,r=a+i>=e.size?e.size:a+i;n.readAsArrayBuffer(File.prototype.slice.call(e,a,r))};c()}));self.onmessage=async function(e){if(e.data.file&&"begin hash"==e.data.msg){const a=await incrementalMD5(e.data.file);postMessage({status:"complete",hash:a})}};