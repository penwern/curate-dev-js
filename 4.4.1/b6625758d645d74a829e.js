importScripts("https://cdnjs.cloudflare.com/ajax/libs/spark-md5/3.0.2/spark-md5.min.js");const incrementalMD5=e=>new Promise(((a,s)=>{var o=0,r=(performance.now(),e.size);const t=new FileReader,n=new SparkMD5.ArrayBuffer,l=2097152,i=Math.ceil(e.size/l);let d=0;console.log("start"),t.onload=e=>{console.log("loaded"),n.append(e.target.result),++d,d<i?c():a(n.end())},t.addEventListener("progress",(e=>{o+=e.loaded;Math.round(o/r*100)})),t.addEventListener("loadend",(e=>{if(e.total>0)performance.now()})),t.onerror=()=>s(t.error);const c=()=>{const a=d*l,s=a+l>=e.size?e.size:a+l;t.readAsArrayBuffer(File.prototype.slice.call(e,a,s))};c()}));self.onmessage=async function(e){if(e.data.file&&"begin hash"==e.data.msg){const a=await incrementalMD5(e.data.file);postMessage({status:"complete",hash:a}),self.close()}};